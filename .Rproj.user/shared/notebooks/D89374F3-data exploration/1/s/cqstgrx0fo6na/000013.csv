"0",""
"0","spot_t <- df %>%"
"0","    filter(Type == ""spot"") %>%"
"0","    dplyr::select(Base, SpotDate = Date, s_t = Mid)"
"0","spot_t1 <- df %>%"
"0","    filter(Type == ""spot"") %>%"
"0","    dplyr::select(Base, Spot1Date = Date, s_t1 = Mid) %>%"
"0","    mutate(date1 = Spot1Date %m+% months(-1))"
"0",""
"0","spot_df <- spot_t %>%"
"0","    inner_join(spot_t1, by = c(""Base"", ""SpotDate"" = ""date1"")) %>%"
"0","    mutate("
"0","        spot = as.numeric(log(s_t)),"
"0","        spot1 = as.numeric(log(s_t1)),"
"0","        excess = as.numeric(spot1 - spot)"
"0","    )"
"2","Warning: Detected an unexpected many-to-many relationship between `x` and `y`."
"0","fwd_df <- df %>%"
"0","    filter(Type == ""forward"") %>%"
"0","    dplyr::select(Base, Date, FwdMid = Mid)"
"0",""
"0","df1 <- fwd_df %>%"
"0","    inner_join(spot_df, by = c(""Base"", ""Date"" = ""SpotDate"")) %>%"
"0","    mutate("
"0","        f_t = as.numeric(FwdMid),"
"0","        fwd = log(f_t),"
"0","        prem = as.numeric(fwd - spot)"
"0","    )"
"2","Warning: Detected an unexpected many-to-many relationship between `x` and `y`."
"0","currencies <- unique(df1$Base)"
